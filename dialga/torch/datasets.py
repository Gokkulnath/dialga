# AUTOGENERATED! DO NOT EDIT! File to edit: 03a_torch.datasets.ipynb (unless otherwise specified).

__all__ = ['FilteredDataset']

# Cell
from torch.utils.data import Dataset #,DataLoader


class FilteredDataset(Dataset):
    '''
    dataset : Any Pytorch Dataset
    wanted_labels : Iterable Containning the labels that are required

    Eg:
    label_5_dataset = FilteredDataset(MNIST(root='',download=True), [5])
    print(len(label_5_dataset))
    '''
    def __init__(self, dataset, wanted_labels=[]):
        self.parent = dataset
        indices = []
        for index, (img, lab) in enumerate(dataset):
            if lab in wanted_labels:
                indices.append(index)
        self.indices = indices

    def __getitem__(self, index):
        return self.parent[self.indices[index]]

    def __len__(self):
        return len(self.indices)

